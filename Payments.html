<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <link rel="stylesheet" href="Payments.css" />
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
</head>
<body>
  <div class="container mt-5 p-3 rounded cart">
    <div class="row no-gutters">
      <div class="col-md-12">
        <div class="product-details mr-2">
          <div class="d-flex flex-row align-items-center" id="navigationarrow">
            <i class="fa fa-long-arrow-left"></i><span class="ml-2">Continue Shopping</span>
          </div>
          <hr />
          <h6 class="mb-0">Shopping cart</h6>
          <div class="d-flex justify-content-between">
            <span id="item-count"></span>
            <div class="d-flex flex-row align-items-center">
              
              <span class="mr-1">Quantity</span>
              <div class="price ml-5">
                <span class="mr-1">Price</span>
                
              </div>

            </div>
          </div>
          <div id="product-container"></div>
          <div class="payment-type">hshsh</div>
        </div>
      </div>
      
      </div>
    </div>
  </div>
  
  <script>
    function getUrlParams() {
      const params = new URLSearchParams(window.location.search);
      return {
        id: params.get("id"),
        name: params.get("name"),
        image: params.get("image"),
        image2: params.get("imageTwo"),
        image3: params.get("imageThree"),
        image4: params.get("imageFour"),
        price: params.get("price"),
        oldPrice: params.get("oldPrice"),
        size: params.get("size"),
        qty: params.get("quantity"),

      };
    }

    function saveToLocalStorage(product) {
      let products = JSON.parse(localStorage.getItem('products')) || [];
      products.push(product);
      localStorage.setItem('products', JSON.stringify(products));
      
    }

    function getFromLocalStorage() {
      return JSON.parse(localStorage.getItem('products')) || [];
    }

    function removeFromLocalStorage(productId) {
      let products = JSON.parse(localStorage.getItem('products')) || [];
      products = products.filter(product => product.id !== productId);
      localStorage.setItem('products', JSON.stringify(products));
      renderProducts();
      
    }

    function renderProducts() {
      const products = getFromLocalStorage();
      const productContainer = document.getElementById("product-container");
      const itemCount = document.getElementById("item-count");
      itemCount.textContent = `You have ${products.length} items in your cart`;
      productContainer.innerHTML = products.map(product => `
        <div class="d-flex justify-content-between align-items-center mt-3 p-2 items rounded" id="product-${product.id}">
          <div class="d-flex flex-row">
            <img class="rounded" src="${product.image}" width="40" />
            <div class="ml-2">
              <span class="font-weight-bold d-block">${product.name}</span><span class="spec">${product.size}</span>
            </div>
          </div>
          <div class="d-flex flex-row align-items-center">
            <span class="d-block">${product.qty}</span><span class="d-block ml-5 font-weight-bold">${product.price}</span>
            <i class="fa fa-trash-o ml-4 text-black-50" onclick="removeFromLocalStorage('${product.id}')"></i>
          </div>
        </div>
      `).join('');
    }
     // product available code
     function productExists(productId) {
  const products = getFromLocalStorage();
  return products.some(product => product.id === productId);
}


    // Retrieve parameters and save them to local storage if they exist
    const product = getUrlParams();
    if (product.id && !productExists(product.id)) {
      saveToLocalStorage(product);
    }

    // Render products on page load
    renderProducts();
  </script>
  
  <script src="payments.js"></script>
</body>
</html>
